{"version":3,"sources":["assets/script/MoneyAnimation.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAM,IAAA,KAAsB,EAAE,CAAC,UAAU,EAAlC,OAAO,aAAA,EAAE,QAAQ,cAAiB,CAAC;AAC1C,SAAS,eAAe;IACpB,OAAO,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,GAAG,CAAC,CAAC;AACjC,CAAC;AAGD;IAA4C,kCAAY;IAAxD;QAAA,qEA2DC;QAxDG,iBAAW,GAAc,IAAI,CAAC;QAG9B,eAAS,GAAW,CAAC,CAAC,CAAG,OAAO;QAGhC,WAAK,GAAW,GAAG,CAAC,CAAK,WAAW;QAGpC,iBAAW,GAAW,GAAG,CAAC,CAAC,YAAY;;IA+C3C,CAAC;IA7CG,+BAAM,GAAN;QACI,mBAAmB;QACnB,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;YACnB,EAAE,CAAC,KAAK,CAAC,0BAA0B,CAAC,CAAC;YACrC,OAAO;SACV;QACD,IAAI,CAAC,SAAS,EAAE,CAAC;IACrB,CAAC;IAED;;OAEG;IACI,kCAAS,GAAhB;QACI,IAAM,MAAM,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,mBAAmB;QAC/C,IAAM,MAAM,GAAG,GAAG,CAAC,CAAS,OAAO;gCAE1B,CAAC;YACN,WAAW;YACX,IAAM,KAAK,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,EAAE,GAAG,OAAK,SAAS,CAAC,GAAG,CAAC,GAAG,eAAe,EAAE,GAAG,GAAG,CAAC;YAC3E,IAAM,SAAS,GAAG,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC;YAC1D,IAAM,IAAI,GAAG,MAAM,CAAC,GAAG,CAAC,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC;YAE/C,aAAa;YACb,IAAI,SAAS,GAAG,EAAE,CAAC,WAAW,CAAC,OAAK,WAAW,CAAC,CAAC;YACjD,SAAS,CAAC,MAAM,GAAG,OAAK,IAAI,CAAC;YAC7B,SAAS,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;YAC9B,SAAS,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;YAExB,IAAI,QAAQ,GAAG,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,GAAG,EAAE,CAAC;YACtC,IAAI,QAAQ,GAAG,QAAQ,GAAG,OAAK,KAAK,CAAC;YAErC,OAAO;YACP,IAAI,UAAU,GAAG,OAAK,WAAW,GAAG,QAAQ,CAAC;YAC7C,wCAAwC;YACxC,EAAE,CAAC,KAAK,CAAC,SAAS,CAAC;iBACd,EAAE,CAAC,QAAQ,EAAE;gBACV,QAAQ,EAAE,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC,EAAC,IAAI,CAAC,CAAC,EAAC,CAAC,CAAC;gBAChC,KAAK,EAAE,UAAU;aACpB,EAAE,EAAE,MAAM,EAAE,WAAW,EAAE,CAAC;iBAC1B,IAAI,CAAC;gBACF,SAAS,CAAC,OAAO,EAAE,CAAC;YACxB,CAAC,CAAC;iBACD,KAAK,EAAE,CAAC;;;QA1BjB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,SAAS,EAAE,EAAE,CAAC;oBAA9B,CAAC;SA2BT;IACL,CAAC;IAvDD;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;uDACU;IAG9B;QADC,QAAQ;qDACa;IAGtB;QADC,QAAQ;iDACW;IAGpB;QADC,QAAQ;uDACiB;IAZT,cAAc;QADlC,OAAO;OACa,cAAc,CA2DlC;IAAD,qBAAC;CA3DD,AA2DC,CA3D2C,EAAE,CAAC,SAAS,GA2DvD;kBA3DoB,cAAc","file":"","sourceRoot":"/","sourcesContent":["const {ccclass, property} = cc._decorator;\nfunction randomMinus1To1(): number {\n    return Math.random() * 2 - 1;\n}\n\n@ccclass\nexport default class MoneyAnimation extends cc.Component {\n\n    @property(cc.Prefab)\n    moneyPrefab: cc.Prefab = null;\n\n    @property\n    emitCount: number = 8;   // 发射数量\n\n    @property\n    speed: number = 300;     // 速度（像素/秒）\n\n    @property\n    rotateSpeed: number = 360; // 旋转速度（度/秒）\n\n    onLoad() {\n        // 确保moneyPrefab已设置\n        if (!this.moneyPrefab) {\n            cc.error(\"Money prefab is not set!\");\n            return;\n        }\n        this.emitMoney();\n    }\n\n    /**\n     * 调用该函数触发飞钱动画\n     */\n    public emitMoney() {\n        const center = cc.v2(0, 0); // 本节点为中心（相对当前节点坐标）\n        const radius = 200;         // 飞行半径\n\n        for (let i = 0; i < this.emitCount; ++i) {\n            // 每个物体的发射角\n            const angle = (2 * Math.PI / this.emitCount) * i + randomMinus1To1() * 0.1;\n            const direction = cc.v2(Math.cos(angle), Math.sin(angle));\n            const dest = center.add(direction.mul(radius));\n\n            // 实例化money对象\n            let moneyNode = cc.instantiate(this.moneyPrefab);\n            moneyNode.parent = this.node;\n            moneyNode.setPosition(center);\n            moneyNode.setScale(0.7);\n\n            let distance = center.sub(dest).mag();\n            let duration = distance / this.speed;\n\n            // 旋转目标\n            let finalAngle = this.rotateSpeed * duration;\n            // 用 cc.tween 添加飞行和旋转动画（2.2.1支持cc.tween）\n            cc.tween(moneyNode)\n                .to(duration, {\n                    position: cc.v3(dest.x,dest.y,0),\n                    angle: finalAngle\n                }, { easing: 'sineInOut' })\n                .call(() => {\n                    moneyNode.destroy();\n                })\n                .start();\n        }\n    }\n}\n"]}